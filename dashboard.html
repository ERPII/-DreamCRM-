<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8"><script src="https://cdn.tailwindcss.com"></script>
    <title>DreamCRM - ×“××©×‘×•×¨×“</title>
</head>
<body class="bg-slate-50 flex h-screen font-[Assistant]">
    <aside class="w-64 bg-slate-900 text-white flex flex-col p-6 shadow-xl shrink-0">
        <div class="text-2xl font-black mb-10 text-blue-400 border-b border-slate-700 pb-4 italic">DreamCRM</div>
        <nav class="flex-1 space-y-2">
            <a href="dashboard.html" class="block p-3 rounded-xl bg-blue-600 font-bold">ğŸ“Š ×“××©×‘×•×¨×“</a>
            <a href="leads.html" class="block p-3 rounded-xl hover:bg-slate-800 transition">ğŸ¯ ×œ×™×“×™×</a>
            <a href="customers.html" class="block p-3 rounded-xl hover:bg-slate-800 transition">ğŸ‘¥ ×œ×§×•×—×•×ª</a>
            <a href="service.html" class="block p-3 rounded-xl hover:bg-slate-800 transition">ğŸ› ï¸ ×©×™×¨×•×ª</a>
            <a id="adminLink" href="users.html" class="hidden block p-3 rounded-xl text-yellow-500 border border-yellow-500/20">ğŸ” × ×™×”×•×œ ×¢×•×‘×“×™×</a>
        </nav>
        <button onclick="window.DreamCRM.logout()" class="p-3 text-red-400 text-right mt-auto">×”×ª× ×ª×§</button>
    </aside>

    <div class="flex-1 flex flex-col min-w-0">
        <header class="h-20 bg-white border-b flex items-center justify-between px-10">
            <div class="font-bold text-slate-800" id="pageTitle">×œ×•×— ×‘×§×¨×”</div>
            <div class="flex items-center gap-3 bg-slate-50 p-2 rounded-2xl border">
                <div class="text-right">
                    <div id="navUserName" class="text-sm font-black">×˜×•×¢×Ÿ...</div>
                    <div id="navUserRole" class="text-[10px] text-blue-600"></div>
                </div>
                <div id="navAvatar" class="w-10 h-10 bg-blue-600 text-white rounded-xl flex items-center justify-center font-bold">?</div>
            </div>
        </header>

        <main class="p-10 overflow-y-auto">
            <div class="grid grid-cols-3 gap-6">
                <div class="bg-white p-8 rounded-3xl shadow-sm border-b-4 border-blue-500">
                    <h3 class="text-gray-400 text-xs font-bold">×œ×™×“×™×</h3>
                    <p id="countLeads" class="text-4xl font-black">0</p>
                </div>
                </div>
        </main>
    </div>

    <script type="module" src="app.js"></script>
    <script type="module">
        import { collection, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
        window.DreamCRM.checkUserStatus(async (user) => {
            if(!user) return location.href='index.html';
            document.getElementById('navUserName').innerText = user.name;
            document.getElementById('navUserRole').innerText = user.role;
            document.getElementById('navAvatar').innerText = user.name.charAt(0);
            if(user.role === 'admin') document.getElementById('adminLink').classList.remove('hidden');
            
            const l = await getDocs(collection(window.db, "leads"));
            document.getElementById('countLeads').innerText = l.size;
        });
    </script>
</body>
</html>
